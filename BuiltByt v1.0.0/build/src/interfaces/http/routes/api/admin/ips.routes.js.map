{"version":3,"file":"ips.routes.js","sources":["src/interfaces/http/routes/api/admin/ips.routes.ts"],"sourceRoot":"/","sourcesContent":["// Importa los tipos necesarios de Express\r\n// import { Request, Response } from 'express';\r\n\r\nimport { authenticateToken } from \"@/interfaces/http/middlewares/jwt/token.middleware\";\r\nimport { RateLimitManager } from \"@/interfaces/messaging/broker/rateLimit\";\r\nimport { TRoutesInput } from \"@/typings/utils\";\r\n\r\nimport ipBlockerControllers from \"../../../controllers/admin/ip.controllers\";\r\nimport { isAdmin } from \"../../../middlewares/jwt/auth.middleware\";\r\n\r\n// Constantes para paths base y versionado\r\nconst BASE_PATH = \"/admin\";\r\nconst API_VERSION = \"/api/v1\";\r\n\r\n/**\r\n * Formatea las rutas de autenticación con el prefijo correcto\r\n * @param path Ruta específica del endpoint\r\n * @returns Ruta completa formateada\r\n */\r\nconst formatRoute = (path: string): string => `${API_VERSION}${BASE_PATH}${path}`;\r\nexport default ({ app }: TRoutesInput) => {\r\n  /**\r\n   * Desbloquea una dirección IP específica.\r\n   * Método: DELETE\r\n   * Ruta: /api/v1/admin/unblock-ip/:ipAddress\r\n   * Middleware: authenticateToken, isAdmin\r\n   * Controlador: ipBlockerControllers.unblockIP\r\n   * Descripción: Permite a un administrador eliminar el bloqueo de una dirección IP específica.\r\n   */\r\n  app.delete(\r\n    formatRoute(\"/unblock-ip/:ipAddress\"),\r\n    RateLimitManager.getInstance().createCustomLimiter({\r\n      max: 10,\r\n      windowMs: 60 * 1000, // 1 minuto\r\n      message: \"Too many requests, please try again later.\",\r\n    }),\r\n    authenticateToken,\r\n    isAdmin,\r\n    ipBlockerControllers.unblockIP,\r\n  );\r\n\r\n  /**\r\n   * Lista todas las direcciones IP bloqueadas.\r\n   * Método: GET\r\n   * Ruta: /api/v1/admin/blocked-ips\r\n   * Middleware: authenticateToken, isAdmin\r\n   * Controlador: ipBlockerControllers.listBlockedIPs\r\n   * Descripción: Devuelve una lista de todas las direcciones IP que están actualmente bloqueadas.\r\n   */\r\n  app.get(\r\n    formatRoute(\"/blocked-ips\"),\r\n    RateLimitManager.getInstance().createCustomLimiter({\r\n      max: 10,\r\n      windowMs: 60 * 1000, // 1 minuto\r\n      message: \"Too many requests, please try again later.\",\r\n    }),\r\n    authenticateToken,\r\n    isAdmin,\r\n    ipBlockerControllers.listBlockedIPs,\r\n  );\r\n\r\n  /**\r\n   * Bloquea una dirección IP específica.\r\n   * Método: POST\r\n   * Ruta: /api/v1/admin/block-ip\r\n   * Middleware: authenticateToken, isAdmin\r\n   * Controlador: ipBlockerControllers.blockIP\r\n   * Descripción: Permite a un administrador bloquear una dirección IP específica.\r\n   */\r\n  app.post(\r\n    formatRoute(\"/block-ip\"),\r\n    RateLimitManager.getInstance().createCustomLimiter({\r\n      max: 10,\r\n      windowMs: 60 * 1000, // 1 minuto\r\n      message: \"Too many requests, please try again later.\",\r\n    }),\r\n    authenticateToken,\r\n    isAdmin,\r\n    ipBlockerControllers.blockIP,\r\n  );\r\n};\r\n"],"names":[],"mappings":";;;AAAA,0CAA0C;AAC1C,+CAA+C;;;;;AAE/C,yFAAuF;AACvF,uEAA2E;AAG3E,+FAA6E;AAC7E,8EAAmE;AAEnE,0CAA0C;AAC1C,MAAM,SAAS,GAAG,QAAQ,CAAC;AAC3B,MAAM,WAAW,GAAG,SAAS,CAAC;AAE9B;;;;GAIG;AACH,MAAM,WAAW,GAAG,CAAC,IAAY,EAAU,EAAE,CAAC,GAAG,WAAW,GAAG,SAAS,GAAG,IAAI,EAAE,CAAC;AAClF,kBAAe,CAAC,EAAE,GAAG,EAAgB,EAAE,EAAE;IACvC;;;;;;;OAOG;IACH,GAAG,CAAC,MAAM,CACR,WAAW,CAAC,wBAAwB,CAAC,EACrC,4BAAgB,CAAC,WAAW,EAAE,CAAC,mBAAmB,CAAC;QACjD,GAAG,EAAE,EAAE;QACP,QAAQ,EAAE,EAAE,GAAG,IAAI,EAAE,WAAW;QAChC,OAAO,EAAE,4CAA4C;KACtD,CAAC,EACF,oCAAiB,EACjB,yBAAO,EACP,wBAAoB,CAAC,SAAS,CAC/B,CAAC;IAEF;;;;;;;OAOG;IACH,GAAG,CAAC,GAAG,CACL,WAAW,CAAC,cAAc,CAAC,EAC3B,4BAAgB,CAAC,WAAW,EAAE,CAAC,mBAAmB,CAAC;QACjD,GAAG,EAAE,EAAE;QACP,QAAQ,EAAE,EAAE,GAAG,IAAI,EAAE,WAAW;QAChC,OAAO,EAAE,4CAA4C;KACtD,CAAC,EACF,oCAAiB,EACjB,yBAAO,EACP,wBAAoB,CAAC,cAAc,CACpC,CAAC;IAEF;;;;;;;OAOG;IACH,GAAG,CAAC,IAAI,CACN,WAAW,CAAC,WAAW,CAAC,EACxB,4BAAgB,CAAC,WAAW,EAAE,CAAC,mBAAmB,CAAC;QACjD,GAAG,EAAE,EAAE;QACP,QAAQ,EAAE,EAAE,GAAG,IAAI,EAAE,WAAW;QAChC,OAAO,EAAE,4CAA4C;KACtD,CAAC,EACF,oCAAiB,EACjB,yBAAO,EACP,wBAAoB,CAAC,OAAO,CAC7B,CAAC;AACJ,CAAC,CAAC","debug_id":"9727ffb4-1a1b-591b-9a95-04fadac538e4"}