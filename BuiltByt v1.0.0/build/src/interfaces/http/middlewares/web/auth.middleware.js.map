{"version":3,"file":"auth.middleware.js","sources":["src/interfaces/http/middlewares/web/auth.middleware.ts"],"sourceRoot":"/","sourcesContent":["import \"passport\"; // <-- Esto importa las extensiones de tipos de passport\r\n\r\nimport { NextFunction, Request, Response } from \"express\";\r\n\r\nimport { main } from \"@/main\";\r\nimport { clientID } from \"@/shared/class/DB\";\r\n\r\n// Extiende la interfaz Request para incluir isAuthenticated\r\n//declare global {\r\n//  namespace Express {\r\n//    interface Request {\r\n//      isAuthenticated?: () => boolean;\r\n//    }\r\n//  }\r\n//}\r\n\r\nexport const AuthPublic = (req: Request, res: Response, next: NextFunction) => {\r\n  if (!req.isAuthenticated || !req.isAuthenticated()) return res.redirect(\"/dashboard/auth\");\r\n  next();\r\n};\r\n\r\nexport const Maintenance = async (req: Request, res: Response, next: NextFunction) => {\r\n  const data = await main.DB.findClient(clientID);\r\n  if (!data || data.maintenance) {\r\n    return res.render(\"maintenance.ejs\", {\r\n      title: \"Nebura - Mantenimiento\",\r\n      user: req.user,\r\n    });\r\n  }\r\n  next();\r\n};\r\n"],"names":[],"mappings":";;;;;AAAA,oBAAkB,CAAC,wDAAwD;AAI3E,iCAA8B;AAC9B,0CAA6C;AAE7C,4DAA4D;AAC5D,kBAAkB;AAClB,uBAAuB;AACvB,yBAAyB;AACzB,wCAAwC;AACxC,OAAO;AACP,KAAK;AACL,GAAG;AAEI,MAAM,UAAU,GAAG,CAAC,GAAY,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;IAC5E,IAAI,CAAC,GAAG,CAAC,eAAe,IAAI,CAAC,GAAG,CAAC,eAAe,EAAE;QAAE,OAAO,GAAG,CAAC,QAAQ,CAAC,iBAAiB,CAAC,CAAC;IAC3F,IAAI,EAAE,CAAC;AACT,CAAC,CAAC;AAHW,QAAA,UAAU,cAGrB;AAEK,MAAM,WAAW,GAAG,KAAK,EAAE,GAAY,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;IACnF,MAAM,IAAI,GAAG,MAAM,WAAI,CAAC,EAAE,CAAC,UAAU,CAAC,aAAQ,CAAC,CAAC;IAChD,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,WAAW,EAAE,CAAC;QAC9B,OAAO,GAAG,CAAC,MAAM,CAAC,iBAAiB,EAAE;YACnC,KAAK,EAAE,wBAAwB;YAC/B,IAAI,EAAE,GAAG,CAAC,IAAI;SACf,CAAC,CAAC;IACL,CAAC;IACD,IAAI,EAAE,CAAC;AACT,CAAC,CAAC;AATW,QAAA,WAAW,eAStB","debug_id":"08ac844d-66cd-57ad-9341-ed0c64553c26"}