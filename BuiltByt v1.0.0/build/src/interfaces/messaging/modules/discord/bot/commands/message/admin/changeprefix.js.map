{"version":3,"file":"changeprefix.js","sources":["src/interfaces/messaging/modules/discord/bot/commands/message/admin/changeprefix.ts"],"sourceRoot":"/","sourcesContent":["import { ActionRowBuilder, ButtonBuilder, ButtonStyle, ChannelType } from \"discord.js\";\r\n\r\nimport { main } from \"@/main\";\r\nimport { EmbedCorrect, ErrorEmbed } from \"@/shared/adapters/extends/embeds.extend\";\r\nimport { Precommand } from \"@typings/modules/discord\";\r\n\r\nconst ChangePrefixCommand: Precommand = {\r\n  name: \"changeprefix\",\r\n  description: \"Change the bot prefix\",\r\n  examples: [\"changeprefix !\", \"changeprefix ?\", \"changeprefix $\"],\r\n  nsfw: false,\r\n  owner: false,\r\n  aliases: [\"cp\"],\r\n  botpermissions: [\"SendMessages\"],\r\n  permissions: [\"Administrator\"],\r\n  async execute(client, message, args, prefix) {\r\n    if (!message.guild || !message.channel || message.channel.type !== ChannelType.GuildText) return;\r\n    const data = await main.prisma.myGuild.findFirst({ where: { guildId: message.guild.id } });\r\n    if (!data)\r\n      return message.reply({\r\n        embeds: [\r\n          new ErrorEmbed()\r\n            .setTitle(\"Error Change Prefix (Admin)\")\r\n            .setDescription(\r\n              [\r\n                `${client.getEmoji(message.guild.id, \"error\")} You need to set up the bot in this server first.`,\r\n                `Use the command \\`${prefix}setup\\` to set up the bot.`,\r\n              ].join(\"\\n\"),\r\n            ),\r\n        ],\r\n      });\r\n\r\n    const newPrefix = args[0];\r\n    if (!newPrefix)\r\n      return message.reply({\r\n        embeds: [\r\n          new ErrorEmbed()\r\n            .setTitle(\"Error Change Prefix (Admin)\")\r\n            .setDescription(\r\n              [\r\n                `${client.getEmoji(message.guild.id, \"error\")} You need to provide a new prefix.`,\r\n                `Usage: \\`${prefix}changeprefix <new prefix>\\``,\r\n              ].join(\"\\n\"),\r\n            ),\r\n        ],\r\n      });\r\n\r\n    if (newPrefix.length > 5)\r\n      return message.reply({\r\n        embeds: [\r\n          new ErrorEmbed()\r\n            .setTitle(\"Error Change Prefix (Admin)\")\r\n            .setDescription(\r\n              [\r\n                `${client.getEmoji(message.guild.id, \"error\")} The prefix cannot be longer than 5 characters.`,\r\n                `Usage: \\`${prefix}changeprefix <new prefix>\\``,\r\n              ].join(\"\\n\"),\r\n            ),\r\n        ],\r\n      });\r\n\r\n    if (newPrefix === data.prefix)\r\n      return message.reply({\r\n        embeds: [\r\n          new ErrorEmbed()\r\n            .setTitle(\"Error Change Prefix (Admin)\")\r\n            .setDescription(\r\n              [\r\n                `${client.getEmoji(message.guild.id, \"error\")} The prefix cannot be the same as the current prefix.`,\r\n                `Usage: \\`${prefix}changeprefix <new prefix>\\``,\r\n              ].join(\"\\n\"),\r\n            ),\r\n        ],\r\n      });\r\n\r\n    const msg = await message.reply({\r\n      embeds: [\r\n        new EmbedCorrect()\r\n          .setTitle(\"Change Prefix (Admin)\")\r\n          .setDescription(\r\n            [\r\n              `${client.getEmoji(message.guild.id, \"loading\")} Changing the prefix...`,\r\n              `New prefix: \\`${newPrefix}\\``,\r\n              `Old prefix: \\`${data.prefix}\\``,\r\n            ].join(\"\\n\"),\r\n          ),\r\n      ],\r\n      components: [\r\n        new ActionRowBuilder<ButtonBuilder>().addComponents(\r\n          new ButtonBuilder()\r\n            .setCustomId(\"confirm\")\r\n            .setLabel(\"Confirm\")\r\n            .setEmoji(client.getEmoji(message.guild.id, \"error\"))\r\n            .setStyle(ButtonStyle.Success),\r\n          new ButtonBuilder()\r\n            .setCustomId(\"cancel\")\r\n            .setLabel(\"Cancel\")\r\n            .setEmoji(client.getEmoji(message.guild.id, \"correct\"))\r\n            .setStyle(ButtonStyle.Danger),\r\n        ),\r\n      ],\r\n    });\r\n\r\n    const filter = (i: any) => i.user.id === message.author.id && i.message.id === msg.id;\r\n    const collector = msg.createMessageComponentCollector({ filter, time: 60000 });\r\n\r\n    collector.on(\"collect\", async (i) => {\r\n      if (!message.guild || !message.channel) return;\r\n      if (i.customId === \"confirm\") {\r\n        await main.prisma.myGuild.update({\r\n          where: { guildId: message.guild.id },\r\n          data: { prefix: newPrefix },\r\n        });\r\n        await msg.edit({\r\n          embeds: [\r\n            new EmbedCorrect()\r\n              .setTitle(\"Change Prefix (Admin)\")\r\n              .setDescription(\r\n                [\r\n                  `${client.getEmoji(message.guild.id, \"success\")} Prefix changed successfully.`,\r\n                  `New prefix: \\`${newPrefix}\\`, Time: \\`${new Date().toLocaleString()}\\``,\r\n                ].join(\"\\n\"),\r\n              ),\r\n          ],\r\n          components: [],\r\n        });\r\n      } else if (i.customId === \"cancel\") {\r\n        await msg.edit({\r\n          embeds: [\r\n            new ErrorEmbed()\r\n              .setTitle(\"Change Prefix (Admin)\")\r\n              .setDescription(\r\n                [\r\n                  `${client.getEmoji(message.guild.id, \"error\")} Prefix change cancelled.`,\r\n                  `thanks for using the command!`,\r\n                ].join(\"\\n\"),\r\n              ),\r\n          ],\r\n          components: [],\r\n        });\r\n      }\r\n    });\r\n\r\n    collector.on(\"end\", async (collected) => {\r\n      if (!message.guild || !message.channel) return;\r\n      if (collected.size === 0) {\r\n        await msg.edit({\r\n          embeds: [\r\n            new ErrorEmbed()\r\n              .setTitle(\"Change Prefix (Admin)\")\r\n              .setDescription(\r\n                [\r\n                  `${client.getEmoji(message.guild.id, \"error\")} Prefix change timed out.`,\r\n                  `thanks for using the command!`,\r\n                ].join(\"\\n\"),\r\n              ),\r\n          ],\r\n          components: [],\r\n        });\r\n      }\r\n    });\r\n\r\n    return;\r\n  },\r\n};\r\n\r\nexport = ChangePrefixCommand;\r\n"],"names":[],"mappings":"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","debug_id":"56e40bb8-2ea8-5dcc-902e-619c83fcae67"}