{"version":3,"file":"end.js","sources":["src/interfaces/messaging/modules/discord/bot/commands/message/admin/giveaways/end.ts"],"sourceRoot":"/","sourcesContent":["import {\r\n\tActionRowBuilder, ButtonBuilder, ButtonStyle, ComponentType, Message,\r\n\tMessageActionRowComponentBuilder, StringSelectMenuBuilder\r\n} from \"discord.js\";\r\n\r\nimport { GiveawayManager } from \"@/main\";\r\nimport { EmbedCorrect, ErrorEmbed } from \"@/shared/adapters/extends/embeds.extend\";\r\nimport { Precommand } from \"@typings/modules/discord\";\r\n\r\nconst GiveawayEnd: Precommand = {\r\n  name: \"giveaway-end\",\r\n  description: \"End a giveaway early and select winners\",\r\n  examples: [\"giveaway end\", \"giveaway end <messageId>\"],\r\n  nsfw: false,\r\n  owner: false,\r\n  permissions: [\"Administrator\"],\r\n  botpermissions: [\"SendMessages\", \"EmbedLinks\", \"ManageMessages\"],\r\n  async execute(_client, message, args) {\r\n    if (!message.guild) {\r\n      return message.reply({\r\n        embeds: [new ErrorEmbed().setDescription(\"This command can only be used in a server.\")],\r\n        allowedMentions: { repliedUser: false },\r\n      });\r\n    }\r\n\r\n    try {\r\n      // Check if a specific giveaway was mentioned\r\n      const targetGiveawayId = args[0];\r\n      if (targetGiveawayId) {\r\n        return endSpecificGiveaway(message, targetGiveawayId);\r\n      }\r\n\r\n      const activeGiveaways = await GiveawayManager.getManager()\r\n        .giveaways.filter((g) => g.guildId === message.guild?.id && !g.ended)\r\n        .sort((a, b) => a.endAt - b.endAt); // Sort by soonest to end\r\n\r\n      if (activeGiveaways.length === 0) {\r\n        return message.reply({\r\n          embeds: [new ErrorEmbed().setDescription(\"There are no active giveaways to end in this server.\")],\r\n          allowedMentions: { repliedUser: false },\r\n        });\r\n      }\r\n\r\n      // If only one active giveaway, skip selection\r\n      if (activeGiveaways.length === 1) {\r\n        return confirmGiveawayEnd(message, activeGiveaways[0]);\r\n      }\r\n\r\n      // Create selection menu for multiple giveaways\r\n      const selectMenu = new StringSelectMenuBuilder()\r\n        .setCustomId(`giveaway_end_select_${message.id}`)\r\n        .setPlaceholder(\"Select a giveaway to end\")\r\n        .addOptions(\r\n          activeGiveaways.slice(0, 25).map((g) => ({\r\n            label: g.prize.length > 100 ? `${g.prize.substring(0, 97)}...` : g.prize,\r\n            description: `Ends in ${formatDuration(g.remainingTime)} | ${g.winnerCount} winner(s)`,\r\n            value: g.messageId,\r\n            emoji: \"‚è±Ô∏è\",\r\n          })),\r\n        );\r\n\r\n      const actionRow = new ActionRowBuilder<MessageActionRowComponentBuilder>().addComponents(selectMenu);\r\n\r\n      const embed = new ErrorEmbed()\r\n        .setTitle(\"üéâ End a Giveaway Early\")\r\n        .setDescription(\"Select the giveaway you want to end from the menu below.\")\r\n        .setFooter({ text: `Found ${activeGiveaways.length} active giveaways` });\r\n\r\n      const response = await message.reply({\r\n        embeds: [embed],\r\n        components: [actionRow],\r\n        allowedMentions: { repliedUser: false },\r\n      });\r\n\r\n      // Handle selection\r\n      const collector = response.createMessageComponentCollector({\r\n        componentType: ComponentType.StringSelect,\r\n        time: 60_000,\r\n        filter: (i) => i.user.id === message.author.id,\r\n      });\r\n\r\n      collector.on(\"collect\", async (selectInteraction) => {\r\n        const selectedId = selectInteraction.values[0];\r\n        const selectedGiveaway = activeGiveaways.find((g) => g.messageId === selectedId);\r\n\r\n        if (!selectedGiveaway) {\r\n          await selectInteraction.reply({\r\n            embeds: [new ErrorEmbed().setDescription(\"The selected giveaway could not be found.\")],\r\n            ephemeral: true,\r\n          });\r\n          return;\r\n        }\r\n\r\n        collector.stop();\r\n        await confirmGiveawayEnd(selectInteraction, selectedGiveaway);\r\n      });\r\n\r\n      collector.on(\"end\", () => {\r\n        response.edit({ components: [] }).catch(console.error);\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Error in giveaway end command:\", error);\r\n      await message.reply({\r\n        embeds: [new ErrorEmbed().setDescription(\"An error occurred while processing the command.\")],\r\n        allowedMentions: { repliedUser: false },\r\n      });\r\n    }\r\n  },\r\n};\r\n\r\n/**\r\n * Ends a specific giveaway by message ID\r\n */\r\nasync function endSpecificGiveaway(message: Message, giveawayId: string) {\r\n  try {\r\n    const giveaway = await GiveawayManager.getManager().giveaways.find(\r\n      (g) => g.messageId === giveawayId && g.guildId === message.guild?.id,\r\n    );\r\n\r\n    if (!giveaway) {\r\n      return message.reply({\r\n        embeds: [new ErrorEmbed().setDescription(`No active giveaway found with ID \\`${giveawayId}\\` in this server.`)],\r\n        allowedMentions: { repliedUser: false },\r\n      });\r\n    }\r\n\r\n    if (giveaway.ended) {\r\n      return message.reply({\r\n        embeds: [new ErrorEmbed().setDescription(`The giveaway for **${giveaway.prize}** has already ended.`)],\r\n        allowedMentions: { repliedUser: false },\r\n      });\r\n    }\r\n\r\n    return confirmGiveawayEnd(message, giveaway);\r\n  } catch (error) {\r\n    console.error(\"Error ending specific giveaway:\", error);\r\n    await message.reply({\r\n      embeds: [new ErrorEmbed().setDescription(\"Failed to process the specified giveaway.\")],\r\n      allowedMentions: { repliedUser: false },\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * Confirms and executes the ending of a giveaway\r\n */\r\nasync function confirmGiveawayEnd(interaction: Message | any, giveaway: any) {\r\n  try {\r\n    const isMessage = interaction instanceof Message;\r\n    const userId = isMessage ? interaction.author.id : interaction.user.id;\r\n\r\n    const embed = new ErrorEmbed()\r\n      .setTitle(\"‚ö†Ô∏è Confirm Giveaway End\")\r\n      .setDescription(\r\n        `You are about to end the giveaway for **${giveaway.prize}**\\n\\n` +\r\n          `- **Winners:** ${giveaway.winnerCount}\\n` +\r\n          `- **Participants:** ${giveaway.entrantIds?.length || 0}\\n` +\r\n          `- **Time remaining:** ${formatDuration(giveaway.remainingTime)}\\n\\n` +\r\n          \"This action cannot be undone. Are you sure you want to proceed?\",\r\n      )\r\n      .setFooter({ text: `Giveaway ID: ${giveaway.messageId}` });\r\n\r\n    const buttons = new ActionRowBuilder<ButtonBuilder>().addComponents(\r\n      new ButtonBuilder()\r\n        .setCustomId(`giveaway_end_confirm_${giveaway.messageId}`)\r\n        .setLabel(\"End Giveaway\")\r\n        .setStyle(ButtonStyle.Danger)\r\n        .setEmoji(\"‚èπÔ∏è\"),\r\n      new ButtonBuilder()\r\n        .setCustomId(`giveaway_end_cancel_${giveaway.messageId}`)\r\n        .setLabel(\"Cancel\")\r\n        .setStyle(ButtonStyle.Secondary)\r\n        .setEmoji(\"‚úñÔ∏è\"),\r\n    );\r\n\r\n    const response = isMessage\r\n      ? await interaction.reply({\r\n          embeds: [embed],\r\n          components: [buttons],\r\n          allowedMentions: { repliedUser: false },\r\n        })\r\n      : await interaction.update({\r\n          embeds: [embed],\r\n          components: [buttons],\r\n        });\r\n\r\n    const collector = response.createMessageComponentCollector({\r\n      componentType: ComponentType.Button,\r\n      time: 60_000,\r\n      filter: (i: { user: { id: any } }) => i.user.id === userId,\r\n    });\r\n\r\n    collector.on(\r\n      \"collect\",\r\n      async (buttonInteraction: import(\"discord.js\").ButtonInteraction<import(\"discord.js\").CacheType>) => {\r\n        try {\r\n          if (buttonInteraction.customId === `giveaway_end_confirm_${giveaway.messageId}`) {\r\n            await buttonInteraction.deferReply();\r\n\r\n            // End the giveaway\r\n            await GiveawayManager.getManager().end(giveaway.messageId);\r\n\r\n            await buttonInteraction.followUp({\r\n              embeds: [\r\n                new EmbedCorrect().setDescription(\r\n                  `Successfully ended the giveaway for **${giveaway.prize}**!\\n` +\r\n                    `[View Giveaway](${giveaway.messageURL})`,\r\n                ),\r\n              ],\r\n              ephemeral: true,\r\n            });\r\n\r\n            // Update the original message\r\n            await response.edit({\r\n              embeds: [\r\n                embed\r\n                  .setTitle(\"‚úÖ Giveaway Ended\")\r\n                  .setColor(\"#00FF00\")\r\n                  .setDescription(\r\n                    `The giveaway for **${giveaway.prize}** has been ended early.\\n\\n` +\r\n                      `[View Giveaway](${giveaway.messageURL})`,\r\n                  ),\r\n              ],\r\n              components: [],\r\n            });\r\n          } else {\r\n            await buttonInteraction.update({\r\n              embeds: [new EmbedCorrect().setDescription(\"Giveaway ending cancelled.\")],\r\n              components: [],\r\n            });\r\n          }\r\n        } catch (error) {\r\n          console.error(\"Error ending giveaway:\", error);\r\n          // Use type assertion to access replied/deferred safely\r\n          if ((buttonInteraction as any).replied || (buttonInteraction as any).deferred) {\r\n            await buttonInteraction.followUp({\r\n              embeds: [\r\n                new ErrorEmbed().setDescription(\"Failed to end the giveaway. Please try again or check permissions.\"),\r\n              ],\r\n              ephemeral: true,\r\n            });\r\n          } else {\r\n            await buttonInteraction.reply({\r\n              embeds: [\r\n                new ErrorEmbed().setDescription(\"Failed to end the giveaway. Please try again or check permissions.\"),\r\n              ],\r\n              ephemeral: true,\r\n            });\r\n          }\r\n        } finally {\r\n          collector.stop();\r\n        }\r\n      },\r\n    );\r\n\r\n    collector.on(\"end\", () => {\r\n      response.edit({ components: [] }).catch(console.error);\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Error in confirmation flow:\", error);\r\n    if (interaction instanceof Message) {\r\n      await interaction.reply({\r\n        embeds: [new ErrorEmbed().setDescription(\"An error occurred during confirmation.\")],\r\n        allowedMentions: { repliedUser: false },\r\n      });\r\n    } else {\r\n      await interaction.followUp({\r\n        embeds: [new ErrorEmbed().setDescription(\"An error occurred during confirmation.\")],\r\n        ephemeral: true,\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nfunction formatDuration(remainingTime: number): string {\r\n  if (remainingTime <= 0) return \"Ended\";\r\n  const seconds = Math.floor((remainingTime / 1000) % 60);\r\n  const minutes = Math.floor((remainingTime / (1000 * 60)) % 60);\r\n  const hours = Math.floor((remainingTime / (1000 * 60 * 60)) % 24);\r\n  const days = Math.floor(remainingTime / (1000 * 60 * 60 * 24));\r\n\r\n  const parts = [];\r\n  if (days > 0) parts.push(`${days}d`);\r\n  if (hours > 0) parts.push(`${hours}h`);\r\n  if (minutes > 0) parts.push(`${minutes}m`);\r\n  if (seconds > 0 && parts.length === 0) parts.push(`${seconds}s`); // Only show seconds if < 1m left\r\n\r\n  return parts.join(\" \");\r\n}\r\n\r\nexport = GiveawayEnd;\r\n"],"names":[],"mappings":"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","debug_id":"d9ddd9dc-23cc-58e2-aa3d-a2e3625c1a5f"}