{"version":3,"file":"addowners.js","sources":["src/interfaces/messaging/modules/discord/bot/commands/message/devs/addowners.ts"],"sourceRoot":"/","sourcesContent":["import {\r\n\tActionRowBuilder, ButtonBuilder, ButtonInteraction, ButtonStyle, ChannelType,\r\n\tUserSelectMenuBuilder, UserSelectMenuInteraction\r\n} from \"discord.js\";\r\n\r\nimport { main } from \"@/main\";\r\nimport { EmbedCorrect } from \"@/shared/adapters/extends/embeds.extend\";\r\nimport { Precommand } from \"@typings/modules/discord\";\r\n\r\nconst OwnerAddCommand: Precommand = {\r\n  name: \"addowners\",\r\n  description: \"Add owners to the bot\",\r\n  examples: [\"addowners\"],\r\n  nsfw: false,\r\n  owner: true,\r\n  aliases: [\"ao\", \"addowner\", \"add-owners\"],\r\n  botpermissions: [\"SendMessages\"],\r\n  permissions: [\"SendMessages\"],\r\n  async execute(client, message) {\r\n    if (!message.guild || !message.channel || message.channel.type !== ChannelType.GuildText || !client.user) return;\r\n    const data = await main.DB.findDiscord(client.user.id);\r\n    if (!data)\r\n      return message.reply({\r\n        embeds: [\r\n          new EmbedCorrect()\r\n            .setTitle(\"Error Add Owners\")\r\n            .setDescription(\r\n              [\r\n                `${client.getEmoji(message.guild.id, \"error\")} The bot is not set up in this server.`,\r\n                `Please restart proyect to set up the bot.`,\r\n              ].join(\"\\n\"),\r\n            ),\r\n        ],\r\n      });\r\n\r\n    const owners = data.owners;\r\n    const msg = await message.reply({\r\n      embeds: [\r\n        new EmbedCorrect()\r\n          .setTitle(\"Add Owners\")\r\n          .setDescription(\r\n            [\r\n              `${client.getEmoji(message.guild.id, \"success\")} Click the select user menu to add owners.`,\r\n              `You can add up to 10 owners.`,\r\n            ].join(\"\\n\"),\r\n          ),\r\n      ],\r\n      components: [\r\n        new ActionRowBuilder<UserSelectMenuBuilder>().addComponents(\r\n          new UserSelectMenuBuilder()\r\n            .setCustomId(\"addowners\")\r\n            .setPlaceholder(\"Select a user to add as owner\")\r\n            .setMinValues(1)\r\n            .setMaxValues(10),\r\n        ),\r\n        new ActionRowBuilder<ButtonBuilder>().addComponents(\r\n          new ButtonBuilder().setCustomId(\"cancel\").setLabel(\"Cancel\").setStyle(ButtonStyle.Danger),\r\n        ),\r\n      ],\r\n    });\r\n\r\n    const filter = (i: { user: { id: string } }) => i.user.id === message.author.id;\r\n    const collector = msg.createMessageComponentCollector({\r\n      filter,\r\n      time: 60000,\r\n    });\r\n\r\n    collector.on(\"collect\", async (i: ButtonInteraction | UserSelectMenuInteraction) => {\r\n      if (!message.guild || !message.channel || !client.user) return;\r\n      if (i.isButton()) {\r\n        if (i.customId === \"cancel\") {\r\n          await msg.edit({\r\n            embeds: [\r\n              new EmbedCorrect()\r\n                .setTitle(\"Add Owners\")\r\n                .setDescription(\r\n                  [\r\n                    `${client.getEmoji(message.guild.id, \"success\")} Cancelled adding owners.`,\r\n                    `You can use the command again to add owners.`,\r\n                  ].join(\"\\n\"),\r\n                ),\r\n            ],\r\n            components: [],\r\n          });\r\n          return collector.stop();\r\n        }\r\n      } else if (i.isUserSelectMenu()) {\r\n        if (i.customId === \"addowners\") {\r\n          const selectedUsers = i.values;\r\n          const newOwners = selectedUsers.filter((userId: string) => !owners.includes(userId));\r\n          if (newOwners.length > 0) {\r\n            await main.prisma.discord.update({\r\n              where: { clientId: client.user.id },\r\n              data: {\r\n                owners: [...owners, ...newOwners],\r\n              },\r\n            });\r\n            await i.reply({\r\n              embeds: [\r\n                new EmbedCorrect()\r\n                  .setTitle(\"Add Owners\")\r\n                  .setDescription(\r\n                    [\r\n                      `${client.getEmoji(message.guild.id, \"success\")} Owners added successfully.`,\r\n                      `New owners: ${newOwners.join(\", \")}`,\r\n                    ].join(\"\\n\"),\r\n                  ),\r\n              ],\r\n            });\r\n          } else {\r\n            await i.reply({\r\n              embeds: [\r\n                new EmbedCorrect()\r\n                  .setTitle(\"Add Owners\")\r\n                  .setDescription(\r\n                    [\r\n                      `${client.getEmoji(message.guild.id, \"error\")} No new owners to add.`,\r\n                      `All selected users are already owners.`,\r\n                    ].join(\"\\n\"),\r\n                  ),\r\n              ],\r\n            });\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    return;\r\n  },\r\n};\r\n\r\nexport = OwnerAddCommand;\r\n"],"names":[],"mappings":"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","debug_id":"9b54628c-b731-53a1-b556-7653dcdc483a"}