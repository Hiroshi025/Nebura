{"version":3,"file":"anime.js","sources":["src/interfaces/messaging/modules/discord/bot/commands/slash/public/anime.ts"],"sourceRoot":"/","sourcesContent":["import axios from \"axios\";\r\nimport { SlashCommandBuilder } from \"discord.js\";\r\nimport moment from \"moment\";\r\n\r\nimport { Command } from \"@/interfaces/messaging/modules/discord/structure/utils/builders\";\r\nimport { EmbedCorrect, ErrorEmbed } from \"@/shared/adapters/extends/embeds.extend\";\r\nimport translate from \"@iamtraction/google-translate\";\r\nimport { Entretenment } from \"@typings/modules/discord\";\r\n\r\nexport default new Command(\r\n  new SlashCommandBuilder()\r\n    .setName(\"anime\")\r\n    .setDescription(\"Search for information about an anime\")\r\n    .addStringOption((option) =>\r\n      option.setName(\"search\").setDescription(\"Provide the name of the anime\").setRequired(true),\r\n    ),\r\n  async (client, interaction) => {\r\n    const { user, options, guild } = interaction;\r\n\r\n    const searchQuery = options.getString(\"search\", true);\r\n    if (!guild) return;\r\n\r\n    try {\r\n      await interaction.reply({\r\n        embeds: [\r\n          new EmbedCorrect().setDescription(\r\n            [`${client.getEmoji(guild.id, \"loading\")} Searching for anime...`, `**Search Query:** ${searchQuery}`].join(\r\n              \"\\n\",\r\n            ),\r\n          ),\r\n        ],\r\n      });\r\n\r\n      const animeResponse = await axios.get<Entretenment.Anime>(\"https://kitsu.io/api/edge/anime\", {\r\n        params: { \"filter[text]\": searchQuery },\r\n      });\r\n\r\n      const anime = animeResponse.data.data[0];\r\n\r\n      if (!anime) {\r\n        return interaction.editReply({\r\n          embeds: [\r\n            new ErrorEmbed().setDescription(\r\n              [\r\n                \"‚ö†Ô∏è | Sorry, I couldn't find any anime with that name!\",\r\n                \"Please check if the name is spelled correctly or try again later.\",\r\n              ].join(\"\\n\"),\r\n            ),\r\n          ],\r\n        });\r\n      }\r\n\r\n      const relatedGenresUrl = anime.relationships.genres.links.related;\r\n\r\n      if (!relatedGenresUrl) {\r\n        return interaction.editReply({\r\n          embeds: [\r\n            new ErrorEmbed().setDescription(\r\n              [\"‚ö†Ô∏è | No genres found for this anime!\", \"Please check if the anime is listed on Kitsu.io.\"].join(\"\\n\"),\r\n            ),\r\n          ],\r\n        });\r\n      }\r\n\r\n      const genreResponse = await axios.get<Entretenment.Genre>(relatedGenresUrl);\r\n      const genres = genreResponse.data.data.map((genre) => genre.attributes.name).join(\", \");\r\n\r\n      const [translatedSynopsis] = await Promise.all([translate(anime.attributes.synopsis, { to: \"en\" })]);\r\n\r\n      const statusMap: Record<string, string> = {\r\n        finished: \"Finished\",\r\n        current: \"Currently Airing\",\r\n        upcoming: \"Upcoming\",\r\n        unreleased: \"Unreleased\",\r\n      };\r\n\r\n      const animeStatus = statusMap[anime.attributes.status.toLowerCase()] || anime.attributes.status;\r\n\r\n      const animeEmbed = new EmbedCorrect()\r\n        .setAuthor({\r\n          name: `Requested by ${user.tag}`,\r\n          iconURL: user.displayAvatarURL(),\r\n        })\r\n        .setTitle(anime.attributes.titles.en_jp || \"Untitled Anime\")\r\n        .setURL(`https://kitsu.io/anime/${anime.id}`)\r\n        .setThumbnail(anime.attributes.posterImage.small)\r\n        .setImage(anime.attributes.coverImage.tiny)\r\n        .setDescription(\r\n          translatedSynopsis.text.length > 900\r\n            ? translatedSynopsis.text.slice(0, 900) + \"...\"\r\n            : translatedSynopsis.text,\r\n        )\r\n        .addFields([\r\n          { name: \"‚åõ Status\", value: animeStatus, inline: true },\r\n          { name: \"üóÉ Type\", value: anime.attributes.subtype || \"Unknown\", inline: true },\r\n          {\r\n            name: \"üèÜ Rank\",\r\n            value: anime.attributes.ratingRank?.toString() || \"Unranked\",\r\n            inline: true,\r\n          },\r\n          {\r\n            name: \"üìÄ Episodes\",\r\n            value: anime.attributes.episodeCount?.toString() || \"Unknown\",\r\n            inline: true,\r\n          },\r\n          {\r\n            name: \"ü•á Popularity\",\r\n            value: anime.attributes.popularityRank?.toString() || \"Unknown\",\r\n            inline: true,\r\n          },\r\n          { name: \"‚ùì Category\", value: anime.type, inline: true },\r\n          {\r\n            name: \"‚≠ê Rating\",\r\n            value: `${anime.attributes.averageRating || \"N/A\"}/100`,\r\n            inline: true,\r\n          },\r\n          {\r\n            name: \"‚åö Duration\",\r\n            value: anime.attributes.episodeLength ? `${anime.attributes.episodeLength} minutes` : \"Unknown\",\r\n            inline: true,\r\n          },\r\n          {\r\n            name: \"üìñ Kitsu Page\",\r\n            value: `[View on Kitsu](https://kitsu.io/anime/${anime.id})`,\r\n            inline: true,\r\n          },\r\n          { name: \"üí† Genres\", value: genres || \"Not specified\", inline: false },\r\n          {\r\n            name: \"üìÖ Air Dates\",\r\n            value: `From **${moment(anime.attributes.startDate).format(\"LL\")}** to **${\r\n              anime.attributes.endDate ? moment(anime.attributes.endDate).format(\"LL\") : \"Present\"\r\n            }**`,\r\n            inline: false,\r\n          },\r\n        ])\r\n        .setTimestamp()\r\n        .setFooter({\r\n          text: `${client.user?.username} | Team`,\r\n          iconURL: client.user?.displayAvatarURL(),\r\n        });\r\n\r\n      await interaction.editReply({ embeds: [animeEmbed] });\r\n    } catch (error) {\r\n      console.error(\"Anime command error:\", error);\r\n      await interaction.editReply({\r\n        embeds: [\r\n          new ErrorEmbed().setDescription(\r\n            [\r\n              \"‚ö†Ô∏è | An error occurred while fetching anime data.\",\r\n              \"Please try again later or check if the anime name is correct.\",\r\n            ].join(\"\\n\"),\r\n          ),\r\n        ],\r\n      });\r\n    }\r\n\r\n    return;\r\n  },\r\n);\r\n"],"names":[],"mappings":"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","debug_id":"15594d70-5ca3-561d-a1ad-6e1761889aa8"}