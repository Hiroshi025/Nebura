{"version":3,"file":"suggest.addon.js","sources":["src/interfaces/messaging/modules/discord/addons/suggestions/suggest.addon.ts"],"sourceRoot":"/","sourcesContent":["/**\r\n * Discord.js imports for building suggestion system UI and handling permissions.\r\n * @packageDocumentation\r\n */\r\nimport {\r\n  ActionRowBuilder,\r\n  ButtonBuilder,\r\n  ButtonStyle,\r\n  ColorResolvable,\r\n  Colors,\r\n  EmbedBuilder,\r\n  MessageFlags,\r\n  PermissionFlagsBits,\r\n} from \"discord.js\";\r\n\r\n/**\r\n * Import Addons structure for Discord modules.\r\n */\r\nimport { Addons } from \"@/interfaces/messaging/modules/discord/structure/addons\";\r\n/**\r\n * Main application entry, used for accessing Prisma and client.\r\n */\r\nimport { main } from \"@/main\";\r\nimport { SuggestRepository } from \"@/shared/adapters/gateaway/suggest.repositories\";\r\n\r\n/**\r\n * Type definition for embed configuration.\r\n */\r\nimport { EmbedConfig } from \"./types\";\r\n\r\n/**\r\n * Suggestion management Discord Addon.\r\n * Handles suggestion messages, voting, and admin approval/rejection.\r\n * @remarks\r\n * This Addon listens to messages in a configured suggestion channel,\r\n * creates suggestion embeds, manages voting via buttons, and allows\r\n * administrators to approve or reject suggestions.\r\n */\r\nexport default new Addons(\r\n  {\r\n    /**\r\n     * Name of the Addon.\r\n     */\r\n    name: \"Suggest Manager\",\r\n    /**\r\n     * Description of the Addon functionality.\r\n     */\r\n    description: \"Manage suggestions in the server.\",\r\n    /**\r\n     * Author of the Addon.\r\n     */\r\n    author: \"Hiroshi025\",\r\n    /**\r\n     * Version of the Addon.\r\n     */\r\n    version: \"1.0.0\",\r\n    /**\r\n     * Required permission bitfields for the Addon.\r\n     */\r\n    bitfield: [\"Administrator\"],\r\n  },\r\n  /**\r\n   * Main Addon logic.\r\n   * @param client - The Discord client instance.\r\n   */\r\n  async (client) => {\r\n    console.debug(\"[SuggestAddon] Addon initialized with client:\", !!client);\r\n\r\n    /**\r\n     * Default embed configuration for suggestions.\r\n     * @type {EmbedConfig}\r\n     */\r\n    const suggestRepository = new SuggestRepository();\r\n    const defaultEmbedConfig: EmbedConfig = {\r\n      color: Colors.Blurple.toString(),\r\n      footer: {\r\n        text: \"Want to suggest something? Type in this channel!\",\r\n      },\r\n    };\r\n\r\n    /**\r\n     * Helper function to create a visual progress bar for voting percentages.\r\n     * @param percentage - The percentage of upvotes.\r\n     * @param length - The total length of the progress bar (default: 10).\r\n     * @returns The formatted progress bar string.\r\n     */\r\n    function createProgressBar(percentage: number, length = 10): string {\r\n      console.debug(\"[SuggestAddon] Creating progress bar:\", { percentage, length });\r\n      const filled = Math.round((percentage / 100) * length);\r\n      return `[${\"‚ñà\".repeat(filled)}${\"‚ñë\".repeat(length - filled)}] ${percentage.toFixed(1)}%`;\r\n    }\r\n\r\n    /**\r\n     * Helper function to get information about the last user who voted.\r\n     * @param guildId - The ID of the guild.\r\n     * @param voters - Array of user IDs who upvoted.\r\n     * @param downvoters - Array of user IDs who downvoted.\r\n     * @returns A string describing the last voter and their action.\r\n     */\r\n    async function getLastVoterInfo(guildId: string, voters: string[], downvoters: string[]): Promise<string> {\r\n      console.debug(\"[SuggestAddon] Getting last voter info:\", { guildId, voters, downvoters });\r\n      const allVoters = [...voters, ...downvoters];\r\n      if (allVoters.length === 0) return \"No votes yet\";\r\n\r\n      const lastVoterId = allVoters[allVoters.length - 1];\r\n      try {\r\n        const guild = await client.guilds.fetch(guildId);\r\n        const member = await guild.members.fetch(lastVoterId);\r\n        return `${member.user.tag} (${voters.includes(lastVoterId) ? \"Upvoted\" : \"Downvoted\"})`;\r\n      } catch {\r\n        return `<@${lastVoterId}> (${voters.includes(lastVoterId) ? \"Upvoted\" : \"Downvoted\"})`;\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Event listener for message creation.\r\n     * Handles new suggestions posted in the suggestion channel.\r\n     */\r\n    client.on(\"messageCreate\", async (message) => {\r\n      if (!message.guild || !message.author) return;\r\n      if (message.author.bot) return; // <-- Agrega esta l√≠nea\r\n\r\n      try {\r\n        /**\r\n         * Fetch guild configuration from the database.\r\n         */\r\n        console.debug(\"[SuggestAddon] Fetching guild config from DB:\", message.guild.id);\r\n        const myGuild = await main.prisma.myGuild.findUnique({\r\n          where: { guildId: message.guild.id },\r\n        });\r\n\r\n        if (!myGuild || !myGuild.suggestChannel) {\r\n          console.debug(\"[SuggestAddon] Guild config or suggestChannel missing:\", { myGuild });\r\n          return;\r\n        }\r\n        if (message.channel.id !== myGuild.suggestChannel) {\r\n          console.debug(\"[SuggestAddon] Message not in suggest channel:\", {\r\n            channelId: message.channel.id,\r\n            suggestChannel: myGuild.suggestChannel,\r\n          });\r\n          return;\r\n        }\r\n\r\n        console.debug(\"[SuggestAddon] messageCreate event triggered:\", {\r\n          guild: !!message.guild,\r\n          author: !!message.author,\r\n          channelId: message.channel?.id,\r\n          content: message.content,\r\n        });\r\n        //if (message.author.bot && message.author.id !== client.user?.id) return;\r\n\r\n        // Delete original message\r\n        await message.delete().catch((err) => {\r\n          console.debug(\"[SuggestAddon] Error deleting original message:\", err);\r\n        });\r\n\r\n        /**\r\n         * Create the suggestion embed with voting fields and user info.\r\n         */\r\n        console.debug(\"[SuggestAddon] Creating suggestion embed for author:\", message.author.id);\r\n        const embed = new EmbedBuilder()\r\n          .setAuthor({\r\n            name: `${message.author.tag}'s Suggestion`,\r\n            iconURL: message.author.displayAvatarURL(),\r\n          })\r\n          .setDescription(message.content || \"\")\r\n          .setColor(\r\n            myGuild.embedColor && /^#[0-9A-F]{6}$/i.test(myGuild.embedColor)\r\n              ? (myGuild.embedColor as ColorResolvable)\r\n              : !isNaN(Number(myGuild.embedColor))\r\n                ? (parseInt(myGuild.embedColor ?? \"0\", 10) as ColorResolvable)\r\n                : (defaultEmbedConfig.color as ColorResolvable),\r\n          )\r\n          .setFooter({\r\n            text: myGuild.footerText || defaultEmbedConfig.footer?.text || \"\",\r\n            iconURL: message.guild.iconURL() || undefined,\r\n          })\r\n          .setThumbnail(message.author.displayAvatarURL())\r\n          .addFields(\r\n            { name: \"üëç Up Votes\", value: \"```0 Votes (0.0%)```\", inline: true },\r\n            { name: \"üëé Down Votes\", value: \"```0 Votes (0.0%)```\", inline: true },\r\n            { name: \"üìä Progress\", value: \"```\" + createProgressBar(0) + \"```\", inline: false },\r\n            { name: \"üÜî Suggested By\", value: `<@${message.author.id}>`, inline: true },\r\n            { name: \"‚è±Ô∏è Last Voter\", value: \"```No votes yet```\", inline: true },\r\n          );\r\n\r\n        // Add image if exists\r\n        const imageAttachment = message.attachments.find((attach) =>\r\n          [\"png\", \"jpeg\", \"jpg\", \"gif\"].some((ext) => attach.url.toLowerCase().endsWith(ext)),\r\n        );\r\n        if (imageAttachment) {\r\n          console.debug(\"[SuggestAddon] Image attachment found:\", imageAttachment.url);\r\n          embed.setImage(imageAttachment.url);\r\n        }\r\n\r\n        /**\r\n         * Create voting and admin action buttons for the suggestion.\r\n         */\r\n        console.debug(\"[SuggestAddon] Creating voting/admin buttons\");\r\n        const upvoteButton = new ButtonBuilder()\r\n          .setCustomId(\"suggest_upvote\")\r\n          .setEmoji(myGuild.approveEmoji || \"üëç\")\r\n          .setLabel(\"0\")\r\n          .setStyle(ButtonStyle.Secondary);\r\n\r\n        const downvoteButton = new ButtonBuilder()\r\n          .setCustomId(\"suggest_downvote\")\r\n          .setEmoji(myGuild.denyEmoji || \"üëé\")\r\n          .setLabel(\"0\")\r\n          .setStyle(ButtonStyle.Secondary);\r\n\r\n        const whoButton = new ButtonBuilder()\r\n          .setCustomId(\"suggest_who\")\r\n          .setEmoji(\"‚ùì\")\r\n          .setLabel(\"Who voted?\")\r\n          .setStyle(ButtonStyle.Primary);\r\n\r\n        // Admin buttons (only visible to admins)\r\n        const approveButton = new ButtonBuilder()\r\n          .setCustomId(\"suggest_approve\")\r\n          .setEmoji(\"‚úÖ\")\r\n          .setLabel(\"Approve\")\r\n          .setStyle(ButtonStyle.Success);\r\n\r\n        const rejectButton = new ButtonBuilder()\r\n          .setCustomId(\"suggest_reject\")\r\n          .setEmoji(\"‚ùå\")\r\n          .setLabel(\"Reject\")\r\n          .setStyle(ButtonStyle.Danger);\r\n\r\n        const row1 = new ActionRowBuilder<ButtonBuilder>().addComponents(upvoteButton, downvoteButton, whoButton);\r\n\r\n        const row2 = new ActionRowBuilder<ButtonBuilder>().addComponents(approveButton, rejectButton);\r\n\r\n        /**\r\n         * Send the suggestion message to the channel.\r\n         */\r\n        console.debug(\"[SuggestAddon] Sending suggestion message to channel\");\r\n        const suggestionMessage = await message.channel.send({\r\n          embeds: [embed],\r\n          components: [row1, row2],\r\n        });\r\n\r\n        /**\r\n         * Save the suggestion details to the database.\r\n         */\r\n        console.debug(\"[SuggestAddon] Saving suggestion to DB:\", {\r\n          suggestId: `${message.guild.id}-${suggestionMessage.id}`,\r\n          messageId: suggestionMessage.id,\r\n          authorId: message.author.id,\r\n        });\r\n        await suggestRepository.createSuggest({\r\n          suggestId: `${message.guild.id}-${suggestionMessage.id}`,\r\n          messageId: suggestionMessage.id,\r\n          content: message.content,\r\n          imageUrl: imageAttachment ? imageAttachment.url : null,\r\n          authorId: message.author.id,\r\n          guildId: message.guild.id,\r\n          status: \"pending\", // New status field\r\n        });\r\n      } catch (error) {\r\n        console.debug(\"[SuggestAddon] Error in messageCreate handler:\", error);\r\n        console.error(\"Error handling suggestion:\", error);\r\n      }\r\n    });\r\n\r\n    client.on(\"interactionCreate\", async (interaction) => {\r\n      console.debug(\"[SuggestAddon] interactionCreate event triggered:\", {\r\n        isButton: interaction.isButton(),\r\n        guild: !!interaction.guild,\r\n        customId: interaction.isButton() ? interaction.customId : undefined,\r\n      });\r\n      if (!interaction.isButton() || !interaction.guild) return;\r\n\r\n      try {\r\n        const customId = interaction.customId;\r\n        console.debug(\"[SuggestAddon] Handling button interaction:\", customId);\r\n\r\n        if (!customId.startsWith(\"suggest_\")) {\r\n          console.debug(\"[SuggestAddon] Not a suggestion interaction:\", customId);\r\n          return;\r\n        }\r\n\r\n        const suggestion = await suggestRepository.getSuggestById(interaction.message.id);\r\n        console.debug(\"[SuggestAddon] Fetched suggestion from DB:\", suggestion);\r\n\r\n        if (!suggestion) {\r\n          console.debug(\"[SuggestAddon] Suggestion not found in DB for message:\", interaction.message.id);\r\n          return interaction.reply({\r\n            content: \"Suggestion not found in the database.\",\r\n            flags: MessageFlags.Ephemeral,\r\n          });\r\n        }\r\n\r\n        const myGuild = await main.prisma.myGuild.findUnique({\r\n          where: { guildId: interaction.guild.id },\r\n        });\r\n        console.debug(\"[SuggestAddon] Fetched guild config for interaction:\", myGuild);\r\n\r\n        if (!myGuild || interaction.channelId !== myGuild.suggestChannel) {\r\n          console.debug(\"[SuggestAddon] Interaction not allowed in this channel:\", {\r\n            channelId: interaction.channelId,\r\n            suggestChannel: myGuild?.suggestChannel,\r\n          });\r\n          return interaction.reply({\r\n            content: \"This interaction is not allowed in this channel.\",\r\n            flags: MessageFlags.Ephemeral,\r\n          });\r\n        }\r\n\r\n        if (suggestion.status !== \"pending\" && !customId.startsWith(\"suggest_who\")) {\r\n          console.debug(\"[SuggestAddon] Suggestion already resolved:\", suggestion.status);\r\n          return interaction.reply({\r\n            content: `This suggestion has already been ${suggestion.status}.`,\r\n            flags: MessageFlags.Ephemeral,\r\n          });\r\n        }\r\n\r\n        const userId = interaction.user.id;\r\n        console.debug(\"[SuggestAddon] Processing interaction for user:\", userId);\r\n\r\n        switch (customId) {\r\n          case \"suggest_upvote\":\r\n            console.debug(\"[SuggestAddon] Upvote button pressed by:\", userId);\r\n            if (suggestion.voters.includes(userId)) {\r\n              console.debug(\"[SuggestAddon] User already upvoted:\", userId);\r\n              return interaction.reply({\r\n                content: \"You can't upvote this suggestion twice!\",\r\n                flags: MessageFlags.Ephemeral,\r\n              });\r\n            }\r\n\r\n            // Remove downvote if exists\r\n            const updatedDownvoters = suggestion.downvoters.filter((id) => id !== userId);\r\n            let downvotes = suggestion.downvotes;\r\n            if (updatedDownvoters.length !== suggestion.downvoters.length) {\r\n              downvotes--;\r\n            }\r\n\r\n            // Add upvote\r\n            const updatedVoters = [...new Set([...suggestion.voters, userId])];\r\n            const upvotes = suggestion.upvotes + 1;\r\n\r\n            await suggestRepository.updateUpvote(\r\n              {\r\n                upvotes,\r\n                downvotes,\r\n                voters: updatedVoters,\r\n                downvoters: updatedDownvoters,\r\n                lastVoter: userId,\r\n              },\r\n              interaction.message.id,\r\n            );\r\n            console.debug(\"[SuggestAddon] Upvote updated in DB for:\", interaction.message.id);\r\n            break;\r\n\r\n          case \"suggest_downvote\":\r\n            console.debug(\"[SuggestAddon] Downvote button pressed by:\", userId);\r\n            if (suggestion.downvoters.includes(userId)) {\r\n              console.debug(\"[SuggestAddon] User already downvoted:\", userId);\r\n              return interaction.reply({\r\n                content: \"You can't downvote this suggestion twice!\",\r\n                flags: MessageFlags.Ephemeral,\r\n              });\r\n            }\r\n\r\n            // Remove upvote if exists\r\n            const updatedVotersDownvote = suggestion.voters.filter((id) => id !== userId);\r\n            let upvotesDownvote = suggestion.upvotes;\r\n            if (updatedVotersDownvote.length !== suggestion.voters.length) {\r\n              upvotesDownvote--;\r\n            }\r\n\r\n            // Add downvote\r\n            const updatedDownvotersDownvote = [...new Set([...suggestion.downvoters, userId])];\r\n            const downvotesDownvote = suggestion.downvotes + 1;\r\n\r\n            await suggestRepository.updateDownvote(\r\n              {\r\n                downvotes: downvotesDownvote,\r\n                voters: updatedVotersDownvote,\r\n                downvoters: updatedDownvotersDownvote,\r\n                lastVoter: userId,\r\n              },\r\n              interaction.message.id,\r\n            );\r\n            console.debug(\"[SuggestAddon] Downvote updated in DB for:\", interaction.message.id);\r\n            break;\r\n\r\n          case \"suggest_who\":\r\n            console.debug(\"[SuggestAddon] Who voted button pressed\");\r\n            const embed = new EmbedBuilder()\r\n              .setTitle(\"‚ùì Who reacted with what? ‚ùì\")\r\n              .setColor(\r\n                myGuild.embedColor && /^#[0-9A-F]{6}$/i.test(myGuild.embedColor)\r\n                  ? (myGuild.embedColor as ColorResolvable)\r\n                  : !isNaN(Number(myGuild.embedColor))\r\n                    ? (parseInt(myGuild.embedColor ?? \"0\", 10) as ColorResolvable)\r\n                    : (defaultEmbedConfig.color as ColorResolvable),\r\n              )\r\n              .addFields(\r\n                {\r\n                  name: `${suggestion.upvotes} Upvotes`,\r\n                  value:\r\n                    suggestion.voters.length > 0\r\n                      ? suggestion.voters\r\n                          .slice(0, 20)\r\n                          .map((id) => `<@${id}>`)\r\n                          .join(\"\\n\")\r\n                      : \"No one\",\r\n                  inline: true,\r\n                },\r\n                {\r\n                  name: `${suggestion.downvotes} Downvotes`,\r\n                  value:\r\n                    suggestion.downvoters.length > 0\r\n                      ? suggestion.downvoters\r\n                          .slice(0, 20)\r\n                          .map((id) => `<@${id}>`)\r\n                          .join(\"\\n\")\r\n                      : \"No one\",\r\n                  inline: true,\r\n                },\r\n              );\r\n\r\n            return interaction.reply({\r\n              embeds: [embed],\r\n              flags: MessageFlags.Ephemeral,\r\n            });\r\n\r\n          case \"suggest_approve\":\r\n          case \"suggest_reject\":\r\n            console.debug(\"[SuggestAddon] Admin action button pressed:\", customId, \"by\", userId);\r\n            // Check if user has admin permissions\r\n            if (!interaction.memberPermissions?.has(PermissionFlagsBits.Administrator)) {\r\n              console.debug(\"[SuggestAddon] User lacks admin permissions:\", userId);\r\n              return interaction.reply({\r\n                content: \"You don't have permission to manage suggestions.\",\r\n                flags: MessageFlags.Ephemeral,\r\n              });\r\n            }\r\n\r\n            const isApproval = customId === \"suggest_approve\";\r\n            const newStatus = isApproval ? \"approved\" : \"rejected\";\r\n            const statusColor = isApproval ? Colors.Green : Colors.Red;\r\n            const statusMessage = isApproval ? \"approved\" : \"rejected\";\r\n\r\n            // Update suggestion status\r\n            await suggestRepository.updateStatus(interaction.message.id, newStatus, interaction.user.id);\r\n            console.debug(\"[SuggestAddon] Suggestion status updated in DB:\", {\r\n              messageId: interaction.message.id,\r\n              newStatus,\r\n              resolvedBy: interaction.user.id,\r\n            });\r\n            // Get the author and guild owner\r\n            const author = await client.users.fetch(suggestion.authorId).catch(() => null);\r\n            const guild = await client.guilds.fetch(suggestion.guildId);\r\n            const owner = await guild.fetchOwner();\r\n\r\n            // Send DM to author\r\n            if (author) {\r\n              try {\r\n                await author.send({\r\n                  content: `Your suggestion in ${guild.name} has been ${statusMessage}:\\n\\n${suggestion.content}`,\r\n                });\r\n                console.debug(\"[SuggestAddon] DM sent to suggestion author:\", author.id);\r\n              } catch (error) {\r\n                console.debug(\"[SuggestAddon] Could not send DM to author:\", author.id, error);\r\n                console.error(`Could not send DM to ${author.tag}`);\r\n              }\r\n            }\r\n\r\n            // Send DM to owner if approved\r\n            if (isApproval && owner && owner.id !== interaction.user.id) {\r\n              try {\r\n                await owner.send({\r\n                  content: `A suggestion in your server ${guild.name} has been approved by ${interaction.user.tag}:\\n\\n${suggestion.content}`,\r\n                });\r\n                console.debug(\"[SuggestAddon] DM sent to server owner:\", owner.id);\r\n              } catch (error) {\r\n                console.debug(\"[SuggestAddon] Could not send DM to server owner:\", owner.id, error);\r\n                console.error(`Could not send DM to server owner ${owner.user.tag}`);\r\n              }\r\n            }\r\n\r\n            // Update the message\r\n            const updatedEmbed = EmbedBuilder.from(interaction.message.embeds[0])\r\n              .setColor(statusColor)\r\n              .setFooter({\r\n                text: `Suggestion ${statusMessage} by ${interaction.user.tag}`,\r\n                iconURL: interaction.user.displayAvatarURL(),\r\n              });\r\n\r\n            // Disable all buttons\r\n            const disabledUpvote = new ButtonBuilder()\r\n              .setCustomId(\"suggest_upvote\")\r\n              .setEmoji(myGuild.approveEmoji || \"üëç\")\r\n              .setLabel(suggestion.upvotes.toString())\r\n              .setStyle(ButtonStyle.Secondary)\r\n              .setDisabled(true);\r\n\r\n            const disabledDownvote = new ButtonBuilder()\r\n              .setCustomId(\"suggest_downvote\")\r\n              .setEmoji(myGuild.denyEmoji || \"üëé\")\r\n              .setLabel(suggestion.downvotes.toString())\r\n              .setStyle(ButtonStyle.Secondary)\r\n              .setDisabled(true);\r\n\r\n            const disabledWho = new ButtonBuilder()\r\n              .setCustomId(\"suggest_who\")\r\n              .setEmoji(\"‚ùì\")\r\n              .setLabel(\"Who voted?\")\r\n              .setStyle(ButtonStyle.Primary)\r\n              .setDisabled(true);\r\n\r\n            const disabledRow = new ActionRowBuilder<ButtonBuilder>().addComponents(\r\n              disabledUpvote,\r\n              disabledDownvote,\r\n              disabledWho,\r\n            );\r\n\r\n            await interaction.message.edit({\r\n              embeds: [updatedEmbed],\r\n              components: [disabledRow],\r\n            });\r\n            console.debug(\"[SuggestAddon] Suggestion message edited after admin action\");\r\n            return interaction.reply({\r\n              content: `Suggestion has been ${statusMessage}.`,\r\n              flags: MessageFlags.Ephemeral,\r\n            });\r\n        }\r\n\r\n        // Update the message with new votes\r\n        const updatedSuggestion = await suggestRepository.getSuggestById(interaction.message.id);\r\n        console.debug(\"[SuggestAddon] Refetched updated suggestion from DB:\", updatedSuggestion);\r\n        if (!updatedSuggestion) return;\r\n\r\n        // Calculate percentages\r\n        const totalVotes = updatedSuggestion.upvotes + updatedSuggestion.downvotes;\r\n        const upvotePercentage = totalVotes > 0 ? (updatedSuggestion.upvotes / totalVotes) * 100 : 0;\r\n        const downvotePercentage = totalVotes > 0 ? (updatedSuggestion.downvotes / totalVotes) * 100 : 0;\r\n\r\n        // Get last voter info\r\n        const lastVoterInfo = await getLastVoterInfo(\r\n          updatedSuggestion.guildId,\r\n          updatedSuggestion.voters,\r\n          updatedSuggestion.downvoters,\r\n        );\r\n        console.debug(\"[SuggestAddon] Last voter info:\", lastVoterInfo);\r\n\r\n        const updatedEmbed = EmbedBuilder.from(interaction.message.embeds[0]).spliceFields(\r\n          0,\r\n          5,\r\n          {\r\n            name: \"üëç Up Votes\",\r\n            value: `\\`\\`\\`${updatedSuggestion.upvotes} Votes (${upvotePercentage.toFixed(1)}%)\\`\\`\\``,\r\n            inline: true,\r\n          },\r\n          {\r\n            name: \"üëé Down Votes\",\r\n            value: `\\`\\`\\`${updatedSuggestion.downvotes} Votes (${downvotePercentage.toFixed(1)}%)\\`\\`\\``,\r\n            inline: true,\r\n          },\r\n          {\r\n            name: \"üìä Progress\",\r\n            value: \"```\" + createProgressBar(upvotePercentage) + \"```\",\r\n            inline: false,\r\n          },\r\n          {\r\n            name: \"üÜî Suggested By\",\r\n            value: `<@${updatedSuggestion.authorId}>`,\r\n            inline: true,\r\n          },\r\n          {\r\n            name: \"‚è±Ô∏è Last Voter\",\r\n            value: `\\`\\`\\`${lastVoterInfo}\\`\\`\\``,\r\n            inline: true,\r\n          },\r\n        );\r\n\r\n        const upvoteButton = new ButtonBuilder()\r\n          .setCustomId(\"suggest_upvote\")\r\n          .setEmoji(myGuild.approveEmoji || \"üëç\")\r\n          .setLabel(updatedSuggestion.upvotes.toString())\r\n          .setStyle(ButtonStyle.Secondary);\r\n\r\n        const downvoteButton = new ButtonBuilder()\r\n          .setCustomId(\"suggest_downvote\")\r\n          .setEmoji(myGuild.denyEmoji || \"üëé\")\r\n          .setLabel(updatedSuggestion.downvotes.toString())\r\n          .setStyle(ButtonStyle.Secondary);\r\n\r\n        const whoButton = new ButtonBuilder()\r\n          .setCustomId(\"suggest_who\")\r\n          .setEmoji(\"‚ùì\")\r\n          .setLabel(\"Who voted?\")\r\n          .setStyle(ButtonStyle.Primary);\r\n\r\n        // Admin buttons\r\n        const approveButton = new ButtonBuilder()\r\n          .setCustomId(\"suggest_approve\")\r\n          .setEmoji(\"‚úÖ\")\r\n          .setLabel(\"Approve\")\r\n          .setStyle(ButtonStyle.Success);\r\n\r\n        const rejectButton = new ButtonBuilder()\r\n          .setCustomId(\"suggest_reject\")\r\n          .setEmoji(\"‚ùå\")\r\n          .setLabel(\"Reject\")\r\n          .setStyle(ButtonStyle.Danger);\r\n\r\n        const row1 = new ActionRowBuilder<ButtonBuilder>().addComponents(upvoteButton, downvoteButton, whoButton);\r\n\r\n        const row2 = new ActionRowBuilder<ButtonBuilder>().addComponents(approveButton, rejectButton);\r\n\r\n        await interaction.message.edit({\r\n          embeds: [updatedEmbed],\r\n          components: [row1, row2],\r\n        });\r\n        console.debug(\"[SuggestAddon] Suggestion message edited after vote\");\r\n\r\n        await interaction.deferUpdate();\r\n        console.debug(\"[SuggestAddon] Interaction deferred update called\");\r\n      } catch (error) {\r\n        console.debug(\"[SuggestAddon] Error in interactionCreate handler:\", error);\r\n        console.error(\"Error handling suggestion interaction:\", error);\r\n        if (interaction.replied || interaction.deferred) {\r\n          await interaction.followUp({\r\n            content: \"An error occurred while processing your interaction.\",\r\n            flags: MessageFlags.Ephemeral,\r\n          });\r\n        } else {\r\n          await interaction.reply({\r\n            content: \"An error occurred while processing your interaction.\",\r\n            flags: MessageFlags.Ephemeral,\r\n          });\r\n        }\r\n      }\r\n\r\n      return;\r\n    });\r\n  },\r\n);\r\n"],"names":[],"mappings":"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","debug_id":"d77f1ade-56c3-5f46-b11e-e9bf55e4c8f4"}