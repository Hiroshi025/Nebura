{"version":3,"file":"status.js","sources":["src/interfaces/messaging/modules/discord/structure/utils/economy/status.ts"],"sourceRoot":"/","sourcesContent":["import { ChatInputCommandInteraction } from \"discord.js\";\r\n\r\nimport { main } from \"@/main\";\r\nimport { EmbedCorrect, ErrorEmbed } from \"@/shared/adapters/extends/embeds.extend\";\r\n\r\nimport { MyClient } from \"../../../client\";\r\n\r\nexport async function StateCommand(interaction: ChatInputCommandInteraction, _client: MyClient) {\r\n  if (!interaction.guild || !interaction.channel) return;\r\n\r\n  const targetUser = interaction.options.getUser(\"user\") || interaction.user;\r\n\r\n  const userEconomy = await main.prisma.userEconomy.findFirst({\r\n    where: { userId: targetUser.id, guildId: interaction.guild.id },\r\n  });\r\n\r\n  if (!userEconomy) {\r\n    return interaction.reply({\r\n      embeds: [\r\n        new ErrorEmbed()\r\n          .setTitle(\"Profile Not Found\")\r\n          .setDescription(`${targetUser.username} does not have an economy profile.`)\r\n          .setColor(\"Red\"),\r\n      ],\r\n      flags: \"Ephemeral\",\r\n    });\r\n  }\r\n\r\n  const leaderboard = await main.prisma.userEconomy.findMany({\r\n    where: { guildId: interaction.guild.id },\r\n    orderBy: { balance: \"desc\" },\r\n    take: 18,\r\n  });\r\n\r\n  const userRank = leaderboard.findIndex((entry) => entry.userId === targetUser.id) + 1;\r\n\r\n  const top3 = leaderboard.slice(0, 3).map((entry, index) => {\r\n    const medal = index === 0 ? \"ü•á\" : index === 1 ? \"ü•à\" : \"ü•â\";\r\n    return `${medal} **${interaction.guild?.members.cache.get(entry.userId)?.user.username || \"Unknown\"}** - $${entry.balance}`;\r\n  });\r\n\r\n  const next15 =\r\n    leaderboard.length > 3\r\n      ? leaderboard.slice(3).map((entry, index) => {\r\n          const rank = index + 4;\r\n          return `**#${rank}** ${interaction.guild?.members.cache.get(entry.userId)?.user.username || \"Unknown\"} - $${entry.balance}`;\r\n        })\r\n      : [\"No more users available in the leaderboard.\"];\r\n\r\n  // Prepare skills display\r\n  let skillsText = \"None\";\r\n  if (userEconomy.skills && typeof userEconomy.skills === \"object\") {\r\n    const skillsObj = userEconomy.skills as Record<string, number>;\r\n    const entries = Object.entries(skillsObj);\r\n    if (entries.length > 0) {\r\n      skillsText = entries.map(([job, lvl]) => `**${job}**: Lv.${lvl}`).join(\", \");\r\n    }\r\n  }\r\n\r\n  // Main profile fields\r\n  const profileFields = [\r\n    {\r\n      name: \"üíµ Balance\",\r\n      value: `$${userEconomy.balance}`,\r\n      inline: true,\r\n    },\r\n    {\r\n      name: \"üèÖ Rank\",\r\n      value: `#${userRank}`,\r\n      inline: true,\r\n    },\r\n    {\r\n      name: \"üåü Prestige\",\r\n      value: `${userEconomy.prestige ?? 0}`,\r\n      inline: true,\r\n    },\r\n    {\r\n      name: \"üëç Reputation\",\r\n      value: `${userEconomy.reputation ?? 0}`,\r\n      inline: true,\r\n    },\r\n    {\r\n      name: \"üíº Job\",\r\n      value: userEconomy.job ? `${userEconomy.job} (Rank ${userEconomy.jobRank ?? 1})` : \"None\",\r\n      inline: true,\r\n    },\r\n    {\r\n      name: \"üóìÔ∏è Job Start Date\",\r\n      value: userEconomy.jobStartDate\r\n        ? `<t:${Math.floor(new Date(userEconomy.jobStartDate).getTime() / 1000)}:D>`\r\n        : \"‚Äî\",\r\n      inline: true,\r\n    },\r\n    {\r\n      name: \"‚è∞ Last Work\",\r\n      value: userEconomy.lastWorkDate\r\n        ? `<t:${Math.floor(new Date(userEconomy.lastWorkDate).getTime() / 1000)}:R>`\r\n        : \"‚Äî\",\r\n      inline: true,\r\n    },\r\n    {\r\n      name: \"üõ†Ô∏è Skills\",\r\n      value: skillsText,\r\n      inline: false,\r\n    },\r\n    {\r\n      name: \"‚öîÔ∏è Duels\",\r\n      value: `Wins: ${userEconomy.wonduels ?? 0} | Losses: ${userEconomy.lostduels ?? 0}`,\r\n      inline: true,\r\n    },\r\n    {\r\n      name: \"üí¨ Messages Sent\",\r\n      value: `${userEconomy.messageCount ?? 0}`,\r\n      inline: true,\r\n    },\r\n  ];\r\n\r\n  // Leaderboard fields\r\n  const leaderboardFields = [\r\n    {\r\n      name: \"üèÜ Top 3 Users\",\r\n      value: top3.join(\"\\n\") || \"No data\",\r\n      inline: false,\r\n    },\r\n    {\r\n      name: \"üìä Next 15 Users\",\r\n      value: next15.join(\"\\n\"),\r\n      inline: false,\r\n    },\r\n  ];\r\n\r\n  const embed = new EmbedCorrect()\r\n    .setTitle(`üí∞ Economy Profile`)\r\n    .setAuthor({ name: targetUser.username, iconURL: targetUser.displayAvatarURL() })\r\n    .setDescription(\"Here is a detailed summary of your economy status and server leaderboard.\")\r\n    .addFields(profileFields)\r\n    .addFields(leaderboardFields)\r\n    .setColor(\"Blue\")\r\n    .setFooter({\r\n      text: `User ID: ${targetUser.id} | Guild: ${interaction.guild.name}`,\r\n      iconURL: interaction.guild.iconURL() ?? undefined,\r\n    });\r\n\r\n  return interaction.reply({ embeds: [embed], flags: \"Ephemeral\" });\r\n}\r\n"],"names":[],"mappings":"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","debug_id":"7ec4a512-a0d3-5aba-ad98-052c7e0c72f8"}