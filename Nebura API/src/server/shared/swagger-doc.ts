import fs from "fs";
import swaggerJSDoc, { OAS3Options } from "swagger-jsdoc";
import yaml from "yaml";

import { config } from "@/shared/utils/config";

/**
 * Loads and parses the Swagger configuration file in YAML format.
 * 
 * @constant {object} swaggerDocument - Represents the content of the Swagger YAML file
 * loaded from the path specified in the configuration.
 */
const swaggerDocument = yaml.parse(
  fs.readFileSync(config.environments.default.api.swagger.local, "utf8")
);

/**
 * Configuration options for generating Swagger documentation.
 * 
 * @constant {OAS3Options} swaggerOptions - Contains the Swagger document definition
 * and an array of file paths with annotations for documentation.
 * 
 * @property {object} definition - The Swagger document definition, loaded from the YAML file.
 * @property {string[]} apis - An array of file paths containing Swagger annotations.
 * Currently, this array is empty.
 */
const swaggerOptions: OAS3Options = {
  definition: swaggerDocument as OAS3Options["definition"],
  apis: [], // Add paths to files with Swagger annotations here.
};

/**
 * Exports the Swagger instance generated with the configured options.
 * 
 * @function
 * @returns {object} - The Swagger instance generated by `swagger-jsdoc`.
 */
export default swaggerJSDoc(swaggerOptions);
